[![build](https://github.com/dzhvansky/raif-bootcamp-2023/actions/workflows/fly.yml/badge.svg)](https://github.com/dzhvansky/raif-bootcamp-2023/actions/workflows/fly.yml) [![python](https://img.shields.io/badge/Python-1.10-3776AB.svg?style=flat&logo=python&logoColor=white)](https://www.python.org) [![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black) [![FastAPI](https://img.shields.io/badge/FastAPI-0.95.0-009688.svg?style=flat&logo=FastAPI&logoColor=white)](https://fastapi.tiangolo.com)

# Raiffeisen bootcamp 2023 - Telegram bot for painting value estimation

Deployed API (docs): https://velvet-wolves-art-expert-api.fly.dev/docs

# Quickstart

Run `poetry install`

Then for API:
1. run `poetry run ./bin/scripts/run-api-dev.sh` for development with autoreload or `poetry run ./bin/app/run-api.sh` for production
1. open http://localhost:8000/docs — FastAPI autogenerated documentation

for BOT:
1. run `TELEGRAM_TOKEN=<your-token-here> poetry run ./bin/app/run-bot.sh`

# Docker

1. Install docker and docker-compose (if not yet)
1. `export TELEGRAM_TOKEN=<your-token-here>`
1. run `docker-compose build`
1. run `docker-compose up`
1. open http://localhost:8000/docs — FastAPI autogenerated documentation
1. bot is also run

# Fly.io

To deploy manually:
1. install flyctl: `brew install flyctl`
1. run `fly deploy --config <fly.api.toml or fly.bot.toml>`

or tag a commit with some version in format `v*.*.*` (for ex. `v1.0.1`) and let CI/CD do its work:
1. `git tag v1.0.1`
1. `git push --tags`

or force deployment manually:
1. go to https://github.com/dzhvansky/raif-bootcamp-2023/actions/workflows/fly.yml
1. Press "Run workflow" button and actually run it
